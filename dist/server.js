(()=>{var e={728:(e,t,a)=>{"use strict";a.r(t);const r=require("express");var n=a.n(r);const l=require("fs");var c=a.n(l);const s=require("path");var o=a.n(s);const i=require("react");var u=a.n(i);const d=require("react-dom/server");var m=a.n(d);const p=require("react-redux"),E=require("react-router-dom/server"),_=require("redux"),h=require("redux-saga");var b=a.n(h);const f=require("react-router-dom"),v=require("@mui/material/Button");var C,I,N,T,S,A,L,y=a.n(v);!function(e){e.CHANGE_CONSTRUCTOR_TYPE="CHANGE_CONSTRUCTOR_TYPE",e.SET_CONSTRUCTOR_PARAMS="SET_CONSTRUCTOR_PARAMS",e.ADD_TABLE="ADD_TABLE",e.UPDATE_TABLE="UPDATE_TABLE",e.DELETE_TABLE="DELETE_TABLE",e.SELECT_TABLE="SELECT_TABLE",e.DELETE_HALL="DELETE_HALL",e.ADD_HALL="ADD_HALL",e.RESET_CONSTRUCTOR="RESET_CONSTRUCTOR",e.SAVE_HALL_ID_IN_CONSTRUCTOR="SAVE_HALL_ID_IN_CONSTRUCTOR",e.ADD_PLACE_IN_TABLE="ADD_PLACE_IN_TABLE",e.DELETE_PLACE_FROM_TABLE="DELETE_PLACE_FROM_TABLE",e.SET_PLACE_MODE="SET_PLACE_MODE"}(C||(C={})),(L=I||(I={})).LOAD_HALLS_REQUEST="LOAD_HALLS_REQUEST",L.LOAD_HALLS_REQUEST_SUCCESS="LOAD_HALLS_REQUEST_SUCCESS",L.ADD_NEW_HALL_REQUEST="ADD_NEW_HALL_REQUEST",L.ADD_NEW_HALL_REQUEST_SUCCESS="ADD_NEW_HALL_REQUEST_SUCCESS",function(e){e.new="new",e.edit="edit",e.view="view"}(N||(N={})),function(e){e.free="FREE",e.reserved="RESERVED",e.notSetting="NOT SETTING"}(T||(T={})),function(e){e.square="square",e.circle="circle"}(S||(S={})),function(e){e.sizeCircle="sizeCircle",e.sizeX="sizeX",e.sizeY="sizeY",e.placesCount="placesCount"}(A||(A={}));var g=function(e){return e.general.halls},w=function(e,t){var a=e.general.halls.find((function(e){return e.hallId===t}));return(null==a?void 0:a.tables)||[]},D=function(e){return{type:C.CHANGE_CONSTRUCTOR_TYPE,mode:e}},R=function(e){return{type:C.SET_CONSTRUCTOR_PARAMS,params:e}};const x=function(e){var t=e.id,a=e.maxTablesCount,r=(0,f.useNavigate)(),n=(0,p.useDispatch)(),l=(0,p.useSelector)((function(e){return w(e,t)})),c=(0,i.useCallback)((function(){var e;n((e=t,{type:C.DELETE_HALL,hallId:e}))}),[]),s=(0,i.useCallback)((function(){var e;n({type:C.RESET_CONSTRUCTOR}),n((e=t,{type:C.SAVE_HALL_ID_IN_CONSTRUCTOR,hallId:e})),r("tableConstructor?type=new")}),[]),o=(0,i.useCallback)((function(e){var a,l,c,s;n(D(e.type)),n((a=t,l=e.tableId,c={placesCount:e.constructorParams.placesCount,sizeCircle:e.constructorParams.sizeCircle,sizeX:e.constructorParams.sizeX,sizeY:e.constructorParams.sizeY},s=e.places,{type:C.SELECT_TABLE,hallId:a,tableId:l,constructorParameters:c,places:s})),r("tableConstructor?type=edit")}),[]);return u().createElement("div",{className:"hall-container"},u().createElement("h2",{className:"hall-container__headline"},"Зал ",t),u().createElement(y(),{className:"hall-container__del-btn",variant:"outlined",sx:{color:"red",border:"1px solid red"},onClick:c},"Удалить"),u().createElement("ul",{className:"hall-list"},l.map((function(e){return u().createElement("li",{key:e.tableId,className:"hall-list-item",onClick:function(){return o(e)}},u().createElement("span",{className:"hall-list-item__id"},"Стол №",e.tableId),u().createElement("span",{className:"hall-list-item__count-places"},"Мест : ",e.places.length))})),l.length<a&&u().createElement("li",{className:"hall-list-item"},u().createElement("button",{className:"hall-container__add-table-btn",type:"button",onClick:s},"Добавить стол"))))},k=require("tslib");var P=function(e){return e.administration.constructor},z=function(e){return e.administration.constructor.mode},O=function(e){return e.administration.constructor.constructorParameters};const U=require("@mui/material/Box");var q=a.n(U);const H=function(e){var t=(0,p.useDispatch)(),a=e.constructorMode,r=e.placeStatus,n=e.tableType,l=e.placeId,c=e.hallId,s=e.tableId,o=function(){if(a===N.view)t(function(e,t,a,r){return{type:C.SET_PLACE_MODE,hallId:e,tableId:t,placeId:a,mode:r}}(c,s,l,T.reserved));else switch(r){case T.free:m(c,s,l);break;case T.notSetting:d(l)}},d=function(e){var a,r={placeId:e,placeStatus:T.free};t((a=r,{type:C.ADD_PLACE_IN_TABLE,place:a}))},m=function(e,a,r){t(function(e,t,a){return{type:C.DELETE_PLACE_FROM_TABLE,hallId:e,tableId:t,placeId:a}}(e,a,r))},E=(0,i.useMemo)((function(){return"square"===n?"table-general-container__place table-general-container__place_square":"circle"===n?"table-general-container__place table-general-container__place_circle":void 0}),[n]);switch(r){case T.notSetting:return u().createElement("button",{className:E,type:"button",onClick:o},"Добавить ",u().createElement("br",null)," место");case T.reserved:return u().createElement("div",{className:"".concat(E," table-general-container__place_reserved")},"Занято");case T.free:return u().createElement("button",{className:E,type:"button",onClick:o},"Свободно");default:return null}},M=function(e){var t=e.constructorMode,a=e.countPlacesCircle,r=e.size,n=e.places,l=e.tableId,c=e.hallId,s=(0,k.__read)(r,2),o=s[0],i=s[1],d=360/a,m=Array.from(Array(a).keys()),p=0;return t===N.view?u().createElement("div",{className:"table-general-container"},u().createElement("div",{className:"circle-table-container"},m.map((function(e){0==e&&(p=0),p+=d;var a=n.find((function(t){return t.placeId===e+1}));return a?u().createElement("div",{key:e,style:{transform:"rotate(".concat(p+"","deg) translateX(-50%)"),transformOrigin:"1px ".concat(50+50*o+"","px")},className:"circle-table-place-wrapper"},u().createElement(H,{constructorMode:t,placeId:e+1,hallId:c,tableId:l,tableType:S.circle,placeStatus:a?a.placeStatus:T.notSetting})):u().createElement("div",{key:e})})),u().createElement(q(),{className:"circle-table-container__table",sx:{width:100*o,height:100*i,backgroundColor:"primary.dark",borderRadius:100,border:"2px solid #000000",position:"relative"}}))):u().createElement("div",{className:"table-general-container"},u().createElement("div",{className:"circle-table-container"},m.map((function(e){0==e&&(p=0),p+=d;var a=n.find((function(t){return t.placeId===e+1}));return u().createElement("div",{key:e,style:{transform:"rotate(".concat(p+"","deg) translateX(-50%)"),transformOrigin:"1px ".concat(50+50*o+"","px")},className:"circle-table-place-wrapper"},u().createElement(H,{constructorMode:t,placeId:e+1,hallId:c,tableId:l,tableType:S.circle,placeStatus:a?a.placeStatus:T.notSetting}))})),u().createElement(q(),{className:"circle-table-container__table",sx:{width:100*o,height:100*i,backgroundColor:"primary.dark",borderRadius:100,border:"2px solid #000000",position:"relative"}})))},B=function(e){var t=e.constructorMode,a=e.size,r=e.places,n=e.tableId,l=e.hallId,c=(0,k.__read)(a,2),s=c[0],o=c[1],i=Array.from(Array((s+2)*(o+2)).keys()),d=0,m=function(e,t){var a=0,r=a+e+1;return t.map((function(n){return n===r+1&&(r=(a=n)+e+1),n<e+1&&n>0||n>t.length-2-e&&n<t.length-1?n:0===a||a===t.length-e-2||n!==a&&n!==r?void 0:n}))}(s,i);return t===N.view?u().createElement("div",{style:{padding:0},className:"table-general-container"},u().createElement("div",{style:{gridTemplateColumns:"repeat(".concat(s+2,", 100px)"),gridTemplateRows:"repeat(".concat(o+2,", 100px)")},className:"square-table-container"},i.map((function(e){if(m.includes(e)){d++;var a=r.find((function(e){return e.placeId===d}));return a?u().createElement(H,{constructorMode:t,placeId:d,hallId:l,tableId:n,tableType:S.square,key:e,placeStatus:a?a.placeStatus:T.notSetting}):u().createElement("div",{key:e})}return u().createElement("div",{key:e})})),u().createElement(q(),{className:"square-table-container__table",sx:{width:"".concat(50+100*s+"","px"),height:"".concat(50+100*o+"","px"),backgroundColor:"primary.dark",border:"2px solid #000000"}}))):u().createElement("div",{style:{padding:0},className:"table-general-container"},u().createElement("div",{style:{gridTemplateColumns:"repeat(".concat(s+2,", 100px)"),gridTemplateRows:"repeat(".concat(o+2,", 100px)")},className:"square-table-container"},i.map((function(e){if(m.includes(e)){d++;var a=r.find((function(e){return e.placeId===d}));return u().createElement(H,{constructorMode:t,placeId:d,hallId:l,tableId:n,tableType:S.square,key:e,placeStatus:a?a.placeStatus:T.notSetting})}return u().createElement("div",{key:e})})),u().createElement(q(),{className:"square-table-container__table",sx:{width:"".concat(50+100*s+"","px"),height:"".concat(50+100*o+"","px"),backgroundColor:"primary.dark",border:"2px solid #000000"}})))},Y=function(e){var t=e.type,a=e.constructorMode,r=e.hallId,n=e.tableId,l=e.places,c=e.constructorParams;switch(t){case S.circle:return u().createElement("div",{className:"table-wrapper"},u().createElement(M,{hallId:r,tableId:n,constructorMode:a,places:l,countPlacesCircle:c.placesCount,size:[c.sizeCircle,c.sizeCircle]}));case S.square:return u().createElement("div",{className:"table-wrapper"},u().createElement(B,{hallId:r,tableId:n,constructorMode:a,places:l,countPlacesCircle:c.placesCount,size:[c.sizeX,c.sizeY]}))}},X=function(e){var t=e.constructorParams,a=e.mode,r=(0,p.useDispatch)(),n=(0,i.useCallback)((function(e){var a={placesCount:t.placesCount,sizeCircle:t.sizeCircle,sizeX:t.sizeX,sizeY:t.sizeY};switch(a[e]++,e){case A.sizeCircle:a[e]<4&&r(R(a));break;case A.sizeX:case A.sizeY:a[e]<8&&r(R(a));break;case A.placesCount:a[e]<21&&r(R(a));break;default:r(R(a))}}),[t]),l=(0,i.useCallback)((function(e){var a={placesCount:t.placesCount,sizeCircle:t.sizeCircle,sizeX:t.sizeX,sizeY:t.sizeY};a[e]--,a[e]>=1&&r(R(a))}),[t]);switch(a){case S.square:return u().createElement("div",{className:"control-panel"},u().createElement("div",{className:"control-panel-element"},u().createElement("div",{className:"control-panel-element-text-wrapper"},u().createElement("span",{className:"control-panel-element-text-wrapper__label"},"Размер по X"),u().createElement("span",{className:"control-panel-element-text-wrapper__value"},t.sizeX)),u().createElement("div",{className:"control-panel-element-btn-wrapper"},u().createElement(y(),{className:"control-panel-element-btn-wrapper__increase-btn",variant:"contained",onClick:function(){return n(A.sizeX)}},"Увеличить"),u().createElement(y(),{className:"control-panel-element-btn-wrapper__decrease-btn",variant:"contained",onClick:function(){return l(A.sizeX)}},"Уменьшить"))),u().createElement("div",{className:"control-panel-element"},u().createElement("div",{className:"control-panel-element-text-wrapper"},u().createElement("span",{className:"control-panel-element-text-wrapper__label"},"Размер по Y"),u().createElement("span",{className:"control-panel-element-text-wrapper__value"},t.sizeY)),u().createElement("div",{className:"control-panel-element-btn-wrapper"},u().createElement(y(),{className:"control-panel-element-btn-wrapper__increase-btn",variant:"contained",onClick:function(){return n(A.sizeY)}},"Увеличить"),u().createElement(y(),{className:"control-panel-element-btn-wrapper__decrease-btn",variant:"contained",onClick:function(){return l(A.sizeY)}},"Уменьшить"))));case S.circle:return u().createElement("div",{className:"control-panel"},u().createElement("div",{className:"control-panel-element"},u().createElement("div",{className:"control-panel-element-text-wrapper"},u().createElement("span",{className:"control-panel-element-text-wrapper__label"},"Размер"),u().createElement("span",{className:"control-panel-element-text-wrapper__value"},t.sizeCircle)),u().createElement("div",{className:"control-panel-element-btn-wrapper"},u().createElement(y(),{className:"control-panel-element-btn-wrapper__increase-btn",variant:"contained",onClick:function(){return n(A.sizeCircle)}},"Увеличить"),u().createElement(y(),{className:"control-panel-element-btn-wrapper__decrease-btn",variant:"contained",onClick:function(){return l(A.sizeCircle)}},"Уменьшить"))),u().createElement("div",{className:"control-panel-element"},u().createElement("div",{className:"control-panel-element-text-wrapper"},u().createElement("span",{className:"control-panel-element-text-wrapper__label"},"Кол-во мест"),u().createElement("span",{className:"control-panel-element-text-wrapper__value"},t.placesCount)),u().createElement("div",{className:"control-panel-element-btn-wrapper"},u().createElement(y(),{className:"control-panel-element-btn-wrapper__increase-btn",variant:"contained",onClick:function(){return n(A.placesCount)}},"Увеличить"),u().createElement(y(),{className:"control-panel-element-btn-wrapper__decrease-btn",variant:"contained",onClick:function(){return l(A.placesCount)}},"Уменьшить"))))}},Q=function(){var e=(0,k.__read)((0,i.useState)(N.new),2),t=e[0],a=e[1],r=(0,k.__read)((0,f.useSearchParams)(),1)[0],n=(0,f.useNavigate)(),l=(0,p.useDispatch)(),c=(0,p.useSelector)(z),s=(0,p.useSelector)(P),o=(0,p.useSelector)(O),d=(0,p.useSelector)((function(e){return w(e,s.hallId)})),m=r.get("type"),E=(0,i.useRef)(!0),_=(0,i.useMemo)((function(){return function(e){var t=1,a=0;if(e.length){var r=e.map((function(e){return e.tableId}));return e.forEach((function(e,n){e.tableId>=a&&(a=e.tableId,a++),t=r.includes(n+1)?a:n+1})),t}return 1}(d)}),[d]);u().useEffect((function(){E.current?E.current=!1:n("/administration")}),[d]),u().useEffect((function(){m===N.edit?a(N.edit):m===N.new&&a(N.new)}),[m]);var h=(0,i.useCallback)((function(){l(D(S.circle))}),[]),b=(0,i.useCallback)((function(){l(D(S.square))}),[]),v=(0,i.useCallback)((function(){var e,a,r={tableId:s.tableId,type:s.mode,maxPlaces:c===S.square?s.constructorParameters.sizeX+s.constructorParameters.sizeY:c===S.circle?s.constructorParameters.placesCount:0,places:s.places,constructorParams:{placesCount:s.constructorParameters.placesCount,sizeCircle:s.constructorParameters.sizeCircle,sizeX:s.constructorParameters.sizeX,sizeY:s.constructorParameters.sizeY}};switch(t){case"edit":r.tableId=s.tableId,l((e=s.hallId,a=r,{type:C.UPDATE_TABLE,hallId:e,table:a}));break;case"new":r.tableId=_,l(function(e,t){return{type:C.ADD_TABLE,hallId:e,table:t}}(s.hallId,r))}}),[s]),I=(0,i.useCallback)((function(){var e,t;l((e=s.hallId,t=s.tableId,{type:C.DELETE_TABLE,hallId:e,tableId:t}))}),[]);return u().createElement("div",{className:"modal-overlay"},u().createElement("div",{className:"constructor-container"},u().createElement("div",{className:"constructor-container-general"},u().createElement("div",{className:"constructor-container-header"},u().createElement(y(),{className:"constructor-container-header__save-btn",variant:"contained",onClick:v},"Сохранить"),t===N.edit&&u().createElement(y(),{className:"constructor-container-header__del-btn",variant:"contained",onClick:I},"Удалить"),u().createElement("h2",{className:"constructor-container-header__headline"},"Конструктор")),u().createElement("div",{className:"contructor-table-type"},u().createElement(y(),{className:"contructor-table-type__square-btn",variant:"outlined",disabled:c===S.square,onClick:b},"Квадратный"),u().createElement(y(),{className:"contructor-table-type__round-btn",variant:"outlined",disabled:c===S.circle,onClick:h},"Круглый")),u().createElement(Y,{constructorParams:o,hallId:s.hallId,tableId:t===N.edit?s.tableId:_,constructorMode:t,places:s.places,type:c,size:[o.sizeX,o.sizeY]})),u().createElement(X,{mode:c,constructorParams:o}),u().createElement("button",{className:"constructor-container__close-btn",type:"button",onClick:function(){n("/administration")}})))};var j=function(){return{type:I.LOAD_HALLS_REQUEST}},F=function(e){return{type:I.LOAD_HALLS_REQUEST_SUCCESS,halls:e}};const W=function(){var e=(0,p.useDispatch)(),t=(0,p.useSelector)(g);u().useEffect((function(){e(j())}),[]);var a=(0,i.useCallback)((function(){var a,r=function(e){var t=1,a=0;if(e.length){var r=e.map((function(e){return e.hallId}));return e.forEach((function(e,n){e.hallId>=a&&(a=e.hallId,a++),t=r.includes(n+1)?a:n+1})),t}return 1}(t);e((a={hallId:r,maxTablesCount:20,tables:[]},{type:C.ADD_HALL,hall:a}))}),[t]);return u().createElement(u().Fragment,null,u().createElement("header",{className:"header-section"},u().createElement("div",{className:"fixed-container flex-container"},u().createElement("h2",{className:"header-section__headline"},"Бронирование столов. Администрирование"),u().createElement("div",{className:"header-info-container"},u().createElement("span",{className:"header-info-container__username"},"Пользователь")))),u().createElement("main",{className:"main-section"},u().createElement("div",{className:"fixed-container flex-container"},u().createElement("div",{className:"add"},u().createElement(y(),{className:"add__btn",variant:"outlined",sx:{border:"1px solid #e87b16",color:"#e87b16"},onClick:a},"Добавить зал")),t.map((function(e){return u().createElement(x,{key:e.hallId,id:e.hallId,maxTablesCount:e.maxTablesCount})})))),u().createElement(f.Routes,null,u().createElement(f.Route,{path:"tableConstructor",element:u().createElement(Q,null)})))},G=function(){var e=(0,p.useSelector)(g);return u().createElement("ul",{className:"reserve-hall-list"},e.map((function(e){return u().createElement("li",{key:e.hallId,className:"reserve-hall-list-item"},u().createElement(f.Link,{className:"reserve-hall-list-item-link",to:"hall/".concat(e.hallId)},u().createElement("h3",{className:"reserve-hall-list-item-link__headline"},"Залл №",e.hallId),u().createElement("span",{className:"reserve-hall-list-item-link__count-tables"},"Количество столов : ",e.tables.length)))})))},V=require("@mui/material/TextField");var J=a.n(V);const $=function(e){var t=(0,f.useNavigate)(),a=e.hallId,r=Number((0,f.useParams)().id),n=(0,k.__read)((0,i.useState)({name:"",phone:""}),2),l=(n[0],n[1],(0,p.useSelector)((function(e){return function(e,t,a){var r=w(e,t);return r.length?r.find((function(e){return e.tableId===a})):{tableId:0,maxPlaces:0,type:S.circle,places:[],constructorParams:{sizeX:1,sizeY:1,sizeCircle:1,placesCount:1}}}(e,a,r)}))),c=(0,i.useCallback)((function(){t("/hall/".concat(a))}),[]),s=(0,i.useCallback)((function(e){e.preventDefault(),alert("Заглушка")}),[]);return u().createElement("div",{className:"modal-overlay"},u().createElement("div",{className:"viewer-container"},u().createElement("h2",{className:"viewer-container__headline"},"Бронирование мест стола №",l.tableId,", зал №",a),u().createElement("button",{className:"viewer-container__close-btn",type:"button",onClick:c}),u().createElement("div",{className:"viewer-main"},u().createElement(Y,{constructorParams:l.constructorParams,constructorMode:N.view,hallId:a,tableId:r,places:l.places,type:l.type,size:[l.constructorParams.sizeX,l.constructorParams.sizeY]}),u().createElement("form",{className:"viewer-main-form",onSubmit:function(e){return s(e)}},u().createElement("h3",{className:"viewer-main-form__headline"},"Информация о бронировании"),u().createElement("div",{className:"field-set"},u().createElement(J(),{id:"viewer-main-form-name",label:"На чьё имя забронировать",variant:"outlined",sx:{width:"100%"}})),u().createElement("div",{className:"field-set"},u().createElement(J(),{id:"viewer-main-form-name-phone",label:"Мобильный телефон",variant:"outlined",sx:{width:"100%"}})),u().createElement(y(),{type:"submit",className:"viewer-main-form__submit-btn",variant:"contained"},"Забронировать")))))},K=function(){var e=(0,f.useParams)().id,t=(0,p.useSelector)((function(t){return w(t,Number(e))}));return u().createElement("div",{className:"reserve-hall"},u().createElement(f.Link,{to:"/"},"Назад"),u().createElement("ul",{className:"reserve-hall-list"},t.map((function(e){var t=0;return e.places.forEach((function(e){e.placeStatus===T.free&&t++})),u().createElement("li",{key:e.tableId,className:"reserve-hall-list-item"},u().createElement(f.Link,{className:"reserve-hall-list-item-link",to:"table/".concat(e.tableId)},u().createElement("h3",{className:"reserve-hall-list-item-link__headline"},"Стол №",e.tableId),u().createElement("span",{className:"reserve-hall-list-item-link__place-count"},"Свободно мест : ",t," из ",e.places.length)))}))),u().createElement(f.Routes,null,u().createElement(f.Route,{path:"table/:id",element:u().createElement($,{hallId:Number(e)})})))},Z=function(){var e=(0,p.useDispatch)();return u().useEffect((function(){e(j())}),[]),u().createElement(u().Fragment,null,u().createElement("header",{className:"header-section"},u().createElement("div",{className:"fixed-container"},u().createElement("h2",{className:""},"Бронирование столов"))),u().createElement("main",{className:"main-section"},u().createElement("div",{className:"fixed-container"},u().createElement("div",{className:"reserve-container"},u().createElement(f.Link,{to:"/administration"},"Перейти в админинистрирование"),u().createElement(f.Routes,null,u().createElement(f.Route,{path:"/",element:u().createElement(G,null)}),u().createElement(f.Route,{path:"hall/:id/*",element:u().createElement(K,null)}))))))},ee=function(){return u().createElement("div",{className:"app-container"},u().createElement("h1",{className:"app-container__headline visually-hidden"},"Сервис бронирование столов"),u().createElement(f.Routes,null,u().createElement(f.Route,{path:"/*",element:u().createElement(Z,null)}),u().createElement(f.Route,{path:"administration/*",element:u().createElement(W,null)})))};var te={mode:S.circle,places:[],constructorParameters:{sizeCircle:2,placesCount:1,sizeX:1,sizeY:1},hallId:0,tableId:0},ae={constructor:te},re={halls:[]},ne={},le=(0,_.combineReducers)({administration:function(e,t){switch(void 0===e&&(e=ae),t.type){case C.SELECT_TABLE:return{constructor:{mode:e.constructor.mode,constructorParameters:t.constructorParameters,places:t.places,hallId:t.hallId,tableId:t.tableId}};case C.CHANGE_CONSTRUCTOR_TYPE:return{constructor:{mode:t.mode,constructorParameters:e.constructor.constructorParameters,places:e.constructor.places,hallId:e.constructor.hallId,tableId:e.constructor.tableId}};case C.SET_CONSTRUCTOR_PARAMS:return{constructor:{mode:e.constructor.mode,constructorParameters:t.params,places:e.constructor.places,hallId:e.constructor.hallId,tableId:e.constructor.tableId}};case C.RESET_CONSTRUCTOR:return{constructor:te};case C.SAVE_HALL_ID_IN_CONSTRUCTOR:return{constructor:{hallId:t.hallId,mode:e.constructor.mode,constructorParameters:e.constructor.constructorParameters,places:e.constructor.places,tableId:e.constructor.tableId}};case C.ADD_PLACE_IN_TABLE:return{constructor:{hallId:e.constructor.hallId,constructorParameters:e.constructor.constructorParameters,mode:e.constructor.mode,tableId:e.constructor.tableId,places:(0,k.__spreadArray)((0,k.__spreadArray)([],(0,k.__read)(e.constructor.places),!1),[t.place],!1)}};case C.DELETE_PLACE_FROM_TABLE:var a=(0,k.__spreadArray)([],(0,k.__read)(e.constructor.places),!1),r=a.find((function(e){return e.placeId===t.placeId}));return a.splice(a.indexOf(r),1),{constructor:{hallId:e.constructor.hallId,constructorParameters:e.constructor.constructorParameters,mode:e.constructor.mode,tableId:e.constructor.tableId,places:a}};default:return e}},general:function(e,t){switch(void 0===e&&(e=re),t.type){case C.ADD_TABLE:var a=e.halls.find((function(e){return e.hallId===t.hallId})),r=e.halls.indexOf(a),n=(0,k.__spreadArray)((0,k.__spreadArray)([],(0,k.__read)(e.halls[r].tables),!1),[t.table],!1),l=(0,k.__spreadArray)([],(0,k.__read)(e.halls),!1);return l[r].tables=n,{halls:l};case C.UPDATE_TABLE:var c=e.halls.find((function(e){return e.hallId===t.hallId})),s=e.halls.indexOf(c),o=(0,k.__spreadArray)([],(0,k.__read)(e.halls[s].tables),!1).map((function(e){return e.tableId===t.table.tableId?t.table:e}));return{halls:e.halls.map((function(e){return e.hallId===t.hallId?{hallId:e.hallId,maxTablesCount:e.maxTablesCount,tables:o}:e}))};case C.DELETE_TABLE:var i=e.halls.find((function(e){return e.hallId===t.hallId})),u=e.halls.indexOf(i),d=e.halls[u].tables.find((function(e){return e.tableId===t.tableId})),m=(0,k.__spreadArray)([],(0,k.__read)(e.halls[u].tables),!1);m.splice(m.indexOf(d),1);var p=(0,k.__spreadArray)([],(0,k.__read)(e.halls),!1);return p[u].tables=m,{halls:p};case C.DELETE_HALL:var E=(0,k.__spreadArray)([],(0,k.__read)(e.halls),!1),_=e.halls.find((function(e){return e.hallId===t.hallId}));return E.splice(e.halls.indexOf(_),1),{halls:E};case C.ADD_HALL:return{halls:(0,k.__spreadArray)((0,k.__spreadArray)([],(0,k.__read)(e.halls),!1),[t.hall],!1)};case I.LOAD_HALLS_REQUEST_SUCCESS:return{halls:t.halls};case C.SET_PLACE_MODE:var h=e.halls.findIndex((function(e){return e.hallId===t.hallId})),b=e.halls[h].tables.findIndex((function(e){return e.tableId===t.tableId})),f=e.halls[h].tables[b].places.findIndex((function(e){return e.placeId===t.placeId})),v=e.halls[h].tables.map((function(e){if(e.tableId===t.tableId){var a=(0,k.__assign)({},e);return a.places[f].placeStatus=T.reserved,a}return e})),N=(0,k.__spreadArray)([],(0,k.__read)(e.halls),!1);return N[h].tables=v,{halls:N};default:return e}},reservation:function(e,t){return void 0===e&&(e=ne),t.type,e}});const ce=require("redux-saga/effects"),se=require("axios");var oe=a.n(se);const ie=function(){return oe().get("/api/load_halls.json")},ue=function(e){return oe().get("/api/load_halls.json")};function de(){var e,t,a;return(0,k.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(0,ce.call)(ie)];case 1:return e=r.sent(),t=e.data.halls,[4,(0,ce.put)(F(t))];case 2:return r.sent(),[3,4];case 3:return a=r.sent(),console.log(a),[3,4];case 4:return[2]}}))}function me(e){var t,a;return(0,k.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(0,ce.call)(ue,e.hall)];case 1:return t=r.sent(),[4,(0,ce.put)((n=t.hall,{type:I.ADD_NEW_HALL_REQUEST_SUCCESS,hall:n}))];case 2:return r.sent(),[3,4];case 3:return a=r.sent(),console.log(a),[3,4];case 4:return[2]}var n}))}function pe(){return(0,k.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,ce.takeEvery)(I.LOAD_HALLS_REQUEST,de)];case 1:return e.sent(),[4,(0,ce.takeEvery)(I.ADD_NEW_HALL_REQUEST,me)];case 2:return e.sent(),[2]}}))}var Ee=n()();Ee.get(/\.(js|css|map|ico|svg|png|gif|bmp|jpeg|jpg|woff|woff2|json)$/,n().static(o().resolve(__dirname,"../dist"))),Ee.use("*",(function(e,t){var a=c().readFileSync(o().resolve("./dist/index.html"),{encoding:"utf8"}),r=b()(),n=(0,_.legacy_createStore)(le,(0,_.applyMiddleware)(r));switch(r.run(pe).toPromise().then((function(){var r=n.getState(),l=m().renderToString(u().createElement(p.Provider,{store:n},u().createElement(E.StaticRouter,{location:e.originalUrl},u().createElement(ee,null))));a=(a=a.replace('<div class="app"></div>','<div class="app">'.concat(l,"</div>"))).replace('<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Сервис бронирования столов</title><script defer="defer" src="bundle.js"><\/script><link href="bundle.css" rel="stylesheet"></head>','<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Сервис бронирования столов</title><script defer="defer" src="bundle.js"><\/script><link href="bundle.css" rel="stylesheet"><script defer="defer">window.REDUX_DATA = '.concat(JSON.stringify(r),"<\/script></head>")),t.contentType("text/html"),t.status(200),t.send(a)})).catch((function(e){return t.status(500)})),console.log(e.url),e.originalUrl){case"/administration":case"/":n.dispatch(j())}n.dispatch(h.END)})),Ee.listen("9000",(function(){console.log("Express server started at <http://localhost:9000>")}))}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var l=t[r]={exports:{}};return e[r](l,l.exports,a),l.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(728)})();